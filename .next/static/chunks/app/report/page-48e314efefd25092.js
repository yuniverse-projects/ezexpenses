(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{67151:(e,t,n)=>{Promise.resolve().then(n.bind(n,62680))},47967:(e,t,n)=>{"use strict";n.d(t,{$1:()=>l,LK:()=>i,On:()=>x,Pd:()=>d,kV:()=>a,vL:()=>c});let r="all_tags_pool",o="bookkeeping_records";function a(){let e=localStorage.getItem(o);return e?JSON.parse(e):[]}function s(e){localStorage.setItem(o,JSON.stringify(e))}function l(e){let t=a();t.push(e),s(t)}function i(e){s(a().filter(t=>t.id!==e))}function c(e){let t=a();s(t=t.map(t=>t.id===e.id?e:t))}function d(){let e=localStorage.getItem(r);return e?JSON.parse(e):[]}function x(e){let t=[...d()];e.forEach(e=>{t.includes(e)||t.push(e)}),localStorage.setItem(r,JSON.stringify(t))}},62680:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>B});var r=n(95155),o=n(12115),a=n(68998),s=n(9552),l=n(9561),i=n(64665),c=n(42479),d=n(10979),x=n(22282),h=n(60615),u=n(83726),m=n(2241),y=n(79214),g=n(47967),j=n(58581),p=n(19117),f=n(15255),A=n(12800),b=n(66963),v=n(27112),S=n(86354),M=n(43322),k=n(14969);function F(e){let{data:t,showIncome:n,showExpense:a,t:s,onBarClick:l}=e,{incomeAvg:i,expenseAvg:c}=(0,o.useMemo)(()=>{if(!t||!t.length)return{incomeAvg:0,expenseAvg:0};let e=0,n=0,r=0;return t.forEach(t=>{t.income>r&&(r=t.income),t.expense>r&&(r=t.expense),e+=t.income,n+=t.expense}),{incomeAvg:e/t.length,expenseAvg:n/t.length}},[t]);return t&&t.length?(0,r.jsx)(j.u,{width:"100%",height:400,children:(0,r.jsxs)(p.E,{data:t,onClick:e=>{l&&l(e)},margin:{top:20,right:20,left:20,bottom:20},children:[(0,r.jsx)(f.d,{strokeDasharray:"3 3"}),(0,r.jsx)(A.W,{tickFormatter:e=>Number(e).toFixed(0),dataKey:"label"}),(0,r.jsx)(b.h,{tickFormatter:e=>Number(e).toFixed(2)}),(0,r.jsx)(v.m,{formatter:(e,t)=>[Number(e).toFixed(2),t]}),(0,r.jsx)(S.s,{}),n&&(0,r.jsx)(M.e,{y:i,stroke:"green",strokeDasharray:"3 3",label:{value:"".concat(s("average"),"(").concat(s("income"),"): ").concat(i.toFixed(2)),position:"top",dy:-5,fill:"green",fontSize:12}}),a&&(0,r.jsx)(M.e,{y:c,stroke:"red",strokeDasharray:"3 3",label:{value:"".concat(s("average"),"(").concat(s("expense"),"): ").concat(c.toFixed(2)),position:"top",dy:15,fill:"red",fontSize:12}}),n&&(0,r.jsx)(k.y,{dataKey:"income",fill:"green",name:s("income"),label:{position:"top",formatter:e=>Number(e).toFixed(2)}}),a&&(0,r.jsx)(k.y,{dataKey:"expense",fill:"red",name:s("expense"),label:{position:"top",formatter:e=>Number(e).toFixed(2)}})]})}):(0,r.jsx)("div",{style:{textAlign:"center"},children:s("noData")})}function w(e){let{records:t,mode:s="freq"}=e,{t:i}=(0,y.Bd)(),c=(0,o.useMemo)(()=>(function(e){let t={};return e.forEach(e=>{(e.tags||[]).forEach(e=>{t[e]=(t[e]||0)+1})}),t})(t),[t]),d=(0,o.useMemo)(()=>(function(e){let t={};return e.forEach(e=>{(e.tags||[]).forEach(n=>{t[n]=(t[n]||0)+e.amount})}),t})(t),[t]),x=(0,o.useMemo)(()=>Array.from(new Set([...Object.keys(c),...Object.keys(d)])),[c,d]),h=(0,o.useMemo)(()=>x.length?Math.max(...x.map(e=>c[e]||0)):1,[x,c]),u=(0,o.useMemo)(()=>x.length?Math.max(...x.map(e=>d[e]||0)):1,[x,d]),m=(0,o.useMemo)(()=>x.map(e=>{let t=c[e]||0,n=d[e]||0;return"freq"===s?{text:e,size:12+24*(h>0?t/h:0),tooltip:"".concat(e,": ").concat(t," ").concat(i("times"))}:{text:e,size:12+24*(u>0?n/u:0),tooltip:"".concat(e,": ").concat(i("currencySymbol")).concat(n.toFixed(2))}}),[x,c,d,s,h,u,i]),[g,j]=(0,o.useState)([]);if((0,o.useEffect)(()=>{if(!m.length){j([]);return}n.e(200).then(n.t.bind(n,62200,23)).then(e=>{(0,e.default)().size([500,500]).words(m).padding(2).spiral("archimedean").rotate(()=>0).font("sans-serif").fontSize(e=>e.size).on("end",e=>j(e)).start()})},[m]),!t.length||!x.length||!g.length)return(0,r.jsx)(l.A,{color:"text.secondary",children:i("noData")});let p=["#8884d8","#82ca9d","#ffc658","#ff8042","#8dd1e1","#d0ed57","#a4de6c","#ffd700"];return(0,r.jsx)(a.A,{sx:{position:"relative",width:"".concat(500,"px"),height:"".concat(500,"px"),margin:"0 auto",backgroundColor:"#fff",borderRadius:"50%",overflow:"hidden"},children:g.map((e,t)=>{let n={position:"absolute",left:250+e.x,top:250+e.y,fontSize:e.size,fontWeight:"bold",color:p[t%p.length],transform:"translate(-50%, -50%)",whiteSpace:"nowrap",cursor:"pointer"};return(0,r.jsx)("span",{style:n,title:e.tooltip,children:e.text},e.text+t)})})}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=0,o=0;return e.forEach(e=>{let a=new Date(e.date);(null===t||a.getFullYear()===t)&&(null===n||a.getMonth()===n)&&("income"===e.type?r+=e.amount:"expense"===e.type&&(o+=e.amount))}),{income:r,expense:o,net:r-o}}function D(e){let{records:t}=e,{t:n}=(0,y.Bd)(),{income:o,expense:s,net:i}=E(t,null,null);return(0,r.jsxs)(d.A,{direction:"row",spacing:2,justifyContent:"space-evenly",children:[(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:n("allRecordsIncome")}),(0,r.jsxs)(l.A,{variant:"h6",children:[n("currencySymbol"),o.toFixed(2)]})]}),(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:n("allRecordsExpense")}),(0,r.jsxs)(l.A,{variant:"h6",children:[n("currencySymbol"),s.toFixed(2)]})]}),(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:n("allRecordsBalance")}),(0,r.jsxs)(l.A,{variant:"h6",color:i>=0?"success.main":"error.main",children:[n("currencySymbol"),i.toFixed(2)]})]})]})}function C(e){let{records:t,year:n}=e,{t:o}=(0,y.Bd)(),{income:s,expense:i,net:c}=E(t,n,null);return(0,r.jsxs)(d.A,{direction:"row",spacing:2,justifyContent:"space-evenly",children:[(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:o("yearTotalIncome")}),(0,r.jsxs)(l.A,{variant:"h6",children:[o("currencySymbol"),s.toFixed(2)]})]}),(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:o("yearTotalExpense")}),(0,r.jsxs)(l.A,{variant:"h6",children:[o("currencySymbol"),i.toFixed(2)]})]}),(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:o("yearTotalBalance")}),(0,r.jsxs)(l.A,{variant:"h6",color:c>=0?"success.main":"error.main",children:[o("currencySymbol"),c.toFixed(2)]})]})]})}function Y(e){let{records:t,year:n,month:o}=e,{t:s}=(0,y.Bd)(),{income:i,expense:c,net:x}=E(t,n,o);return(0,r.jsxs)(d.A,{direction:"row",spacing:2,justifyContent:"space-evenly",children:[(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:s("monthTotalIncome")}),(0,r.jsxs)(l.A,{variant:"h6",children:[s("currencySymbol"),i.toFixed(2)]})]}),(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:s("monthTotalExpense")}),(0,r.jsxs)(l.A,{variant:"h6",children:[s("currencySymbol"),c.toFixed(2)]})]}),(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:s("monthTotalBalance")}),(0,r.jsxs)(l.A,{variant:"h6",color:x>=0?"success.main":"error.main",children:[s("currencySymbol"),x.toFixed(2)]})]})]})}function B(){let{t:e}=(0,y.Bd)(),[t,n]=(0,o.useState)([]),[j,p]=(0,o.useState)("yearMonths"),[f,A]=(0,o.useState)(new Date().getFullYear()),[b,v]=(0,o.useState)(0),[S,M]=(0,o.useState)(!0),[k,E]=(0,o.useState)(!0),[B,I]=(0,o.useState)("freq");(0,o.useEffect)(()=>{n((0,g.kV)())},[]);let{income:N,expense:z,net:O}=(0,o.useMemo)(()=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=0,o=0;return e.forEach(e=>{let a=new Date(e.date);(null===t||a.getFullYear()===t)&&(null===n||a.getMonth()===n)&&("income"===e.type?r+=e.amount:"expense"===e.type&&(o+=e.amount))}),{income:r,expense:o,net:r-o}})(t,f),[t,f]),T=(0,o.useMemo)(()=>{let e=new Map;t.forEach(t=>{let n=new Date(t.date).getFullYear();e.has(n)||e.set(n,{income:0,expense:0}),"income"===t.type?e.get(n).income+=t.amount:"expense"===t.type&&(e.get(n).expense+=t.amount)});let n=[...e.entries()].map(e=>{let[t,n]=e;return{label:t.toString(),income:n.income,expense:n.expense}});return n.sort((e,t)=>parseInt(e.label)-parseInt(t.label)),n},[t]),_=(0,o.useMemo)(()=>{let e=Array.from({length:12},(e,t)=>({label:(t+1).toString(),income:0,expense:0}));return t.forEach(t=>{let n=new Date(t.date);n.getFullYear()===f&&("income"===t.type?e[n.getMonth()].income+=t.amount:e[n.getMonth()].expense+=t.amount)}),e},[t,f]),W=(0,o.useMemo)(()=>{let e=Array.from({length:new Date(f,b+1,0).getDate()},(e,t)=>({label:(t+1).toString(),income:0,expense:0}));return t.forEach(t=>{let n=new Date(t.date);n.getFullYear()===f&&n.getMonth()===b&&("income"===t.type?e[n.getDate()-1].income+=t.amount:e[n.getDate()-1].expense+=t.amount)}),e},[t,f,b]),q=(0,o.useMemo)(()=>"allYears"===j?T:"yearMonths"===j?_:"monthDays"===j?W:[],[j,T,_,W]),R=(0,o.useMemo)(()=>t.filter(e=>"expense"===e.type),[t]),J=(0,o.useMemo)(()=>t.filter(e=>"income"===e.type),[t]);return(0,r.jsx)(a.A,{sx:{backgroundColor:"#f7f9fc",minHeight:"100vh",py:4},children:(0,r.jsxs)(s.A,{maxWidth:"lg",children:[(0,r.jsxs)(a.A,{sx:{textAlign:"center",mb:4},children:[(0,r.jsx)(l.A,{variant:"h4",sx:{fontWeight:"bold"},children:e("EZExpensesReport")}),(0,r.jsx)(l.A,{variant:"subtitle1",color:"text.secondary",children:e("poweredBy")})]}),(0,r.jsx)(i.A,{variant:"outlined",sx:{mb:3},children:(0,r.jsxs)(c.A,{children:[(0,r.jsx)(l.A,{variant:"h6",sx:{mb:2},children:e("currentYearStats",{year:f})}),(0,r.jsxs)(d.A,{direction:"row",spacing:2,justifyContent:"space-evenly",sx:{mb:2},children:[(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:e("yearlyIncome")}),(0,r.jsxs)(l.A,{variant:"h6",children:[e("currencySymbol"),N.toFixed(2)]})]}),(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:e("yearlyExpense")}),(0,r.jsxs)(l.A,{variant:"h6",children:[e("currencySymbol"),z.toFixed(2)]})]}),(0,r.jsxs)(a.A,{textAlign:"center",children:[(0,r.jsx)(l.A,{variant:"subtitle2",color:"text.secondary",children:e("yearlyBalance")}),(0,r.jsxs)(l.A,{variant:"h6",color:O>=0?"success.main":"error.main",children:[e("currencySymbol"),O.toFixed(2)]})]})]})]})}),(0,r.jsx)(i.A,{variant:"outlined",children:(0,r.jsxs)(c.A,{children:["allYears"!==j&&(0,r.jsx)(x.A,{variant:"outlined",onClick:function(){"monthDays"===j?p("yearMonths"):"yearMonths"===j&&p("allYears")},sx:{mb:2},children:e("back")}),(0,r.jsx)(l.A,{variant:"h5",sx:{mb:2,fontWeight:"bold"},children:"allYears"===j?e("allYearsTrend"):"yearMonths"===j?"".concat(f,"年 ").concat(e("monthlyTrend")):"monthDays"===j?"".concat(f,"年").concat(b+1,"月 ").concat(e("dailyTrend")):""}),(0,r.jsxs)(d.A,{direction:"row",spacing:2,sx:{mb:2},children:[(0,r.jsx)(h.A,{control:(0,r.jsx)(u.A,{checked:S,onChange:e=>M(e.target.checked),color:"success"}),label:e("income")}),(0,r.jsx)(h.A,{control:(0,r.jsx)(u.A,{checked:k,onChange:e=>E(e.target.checked),color:"error"}),label:e("expense")})]}),(0,r.jsx)(a.A,{sx:{width:"100%",height:400},children:q.length?(0,r.jsx)(F,{data:q,showIncome:S,showExpense:k,t:e,onBarClick:function(e){var t;if(!(null==e?void 0:e.activePayload))return;let n=null===(t=e.activePayload[0])||void 0===t?void 0:t.payload;n&&("allYears"===j?(A(parseInt(n.label,10)),p("yearMonths")):"yearMonths"===j&&(v(parseInt(n.label,10)-1),p("monthDays")))}}):(0,r.jsx)(l.A,{color:"text.secondary",children:e("noData")})}),(0,r.jsx)(m.A,{sx:{my:2}}),"allYears"===j&&(0,r.jsx)(D,{records:t}),"yearMonths"===j&&(0,r.jsx)(C,{records:t,year:f}),"monthDays"===j&&(0,r.jsx)(Y,{records:t,year:f,month:b})]})}),(0,r.jsx)(i.A,{variant:"outlined",sx:{mt:3},children:(0,r.jsxs)(c.A,{children:[(0,r.jsxs)(l.A,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"bold"},children:[e("tagCloud")," - ",e("expenseStats")]}),(0,r.jsx)(m.A,{sx:{mb:3}}),(0,r.jsxs)(d.A,{direction:"row",spacing:2,sx:{mb:2},children:[(0,r.jsx)(x.A,{variant:"freq"===B?"contained":"outlined",onClick:()=>I("freq"),children:e("frequency")}),(0,r.jsx)(x.A,{variant:"amount"===B?"contained":"outlined",onClick:()=>I("amount"),children:e("amount")})]}),(0,r.jsx)(w,{records:R,mode:B})]})}),(0,r.jsx)(i.A,{variant:"outlined",sx:{mt:3},children:(0,r.jsxs)(c.A,{children:[(0,r.jsxs)(l.A,{variant:"h6",gutterBottom:!0,sx:{fontWeight:"bold"},children:[e("tagCloud")," - ",e("incomeStats")]}),(0,r.jsx)(m.A,{sx:{mb:3}}),(0,r.jsx)(w,{records:J,mode:B})]})})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[214,37,804,327,441,517,358],()=>t(67151)),_N_E=e.O()}]);